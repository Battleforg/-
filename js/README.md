# JavaScript 整理

## 作用域
**《JavaScript高级程序设计》第四版**

任何变量（不管包含的是原始值还是引用值）都存在于某个执行上下文中（也被称为作用域）。这个上下文（作用域）决定了变量的生存周期，以及它们可以访问代码的哪些部分。

每个上下文都有一个关联的变量对象，而这个上下文中定义的所有变量都会存在这个对象上。

执行上下文可以总结如下。
1. 执行上下文可以分为全局上下文、函数上下文和块级上下文。在浏览器中，全局上下文是window对象。
2. 作用域链和上下文栈对应，代码执行流每进入一个新的上下文，不仅会在当前上下文栈顶压入这个新的上下文，还会创建一个将不同上下文的变量对象连在一起的作用域链，用于搜索变量和函数。作用域链的第一个变量对象是当前活动的上下文，下一个变量对象来自包含上下文，再下一个对象来自包含上下文的包含上下文，以此类推直至全局上下文。
3. 函数或块的局部上下文不仅可以访问自己作用域内的变量，还可以通过作用域链访问任何包含上下文乃至全局上下文中的变量。代码执行时的标识符解析是通过沿作用域链逐级搜索标识符名称完成的，搜索过程从作用域链的最前端开始，然后逐级往后，直到找到标识符，或者报错
4. 全局上下文只能访问全局上下文中的变量和函数，不能直接访问局部上下文中的任何数据。可以进一步推广，包含上下文只能访问从自己到全局上下文中定义的变量，不能访问内部作用域内的变量。
5. 变量的上下文用于确定什么时候释放内存。

## 垃圾回收

1. 离开作用域的值会被自动标记为可回收，然后在垃圾回收期间被删除。
2. 主流的垃圾回收算法是标记清理，即给当前不使用的值加上标记，方法有很多，如进入变量进入上下文时反转某一位，或者维护“在上下文”和“不在上下文”两个变量列表。
3. 可以通过解除引用、使用let和const、小心使用闭包等方式优化内存使用